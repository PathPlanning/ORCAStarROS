<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>ORCAStar: ORCA* ROS</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ORCA* ROS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Decentralized navigation system based on ORCA and Theta* algorithms and implemented as ROS nodes</p>
<h2>ORCA* Algorithm</h2>
<h3>Description</h3>
<p>The algorithm is based on the idea of planning a global path for all agents independently and moving along this path with local collision avoidance. Theta* algorithm are using to global path planning and ORCA algorithm are using for local collision avoidance with agents and static obstacles. Also direct moving to goal without global planning is available.</p>
<p><b>Theta*</b> is a version of A* algorithm for any-angle path planning on grids. Theta* mostly the same as A*, but, unlike A*, Theta* allows parent of current vertex may be any other vertex, which are visible from current [<a href="https://arxiv.org/pdf/1401.3843.pdf">1</a>].</p>
<p>The <b>ORCA</b> algorithm is a decentralized collision avoidance algorithm in a multi-agent environment. The main idea of ​​the algorithm is iterative selection of new agent speed, close to a certain preferred velocity. Selection of the new speed is based on ORCA principle. <b>Optimal Reciprocal Collision Avoidance (ORCA)</b> — the principle, which provides a sufficient condition for multiple robots to avoid collisions among one another, and thus can guarantee collision-free navigation [<a href="http://gamma.cs.unc.edu/ORCA/publications/ORCA.pdf">2</a>]. The principle is based on the concept of velocity obstacles, which are used to search for a new speed of agent so that during the time <em>t</em> there is no collision with other agents. In the process of searching for a new velocity, algorithm creates a set of n-1 linear constraints(where n is the number of agents that the current one takes into account). A new velocity (Vnew) that satisfies these constraints and is close to the preferred velocity, are searched using an linear programming. The preferred velocity is selected so that the agent makes a move to the target point. More information about ORCA algorithm you can find at ORCA creators web page [<a href="http://gamma.cs.unc.edu/ORCA/">3</a>].</p>
<p>The agent is a disk of radius <em>r</em> with buffer radius <em>ε</em> centered at <em>p</em> with their start and global goal positions.</p>
<div class="image">
<img src="./images/reps.png"  width="300" alt="Agent sheme"/>
</div>
 <p>For each neighboring agent (located at a distance <em>R</em> or less), their position and current speed are known. At the beginning of task execution every agent tries to find a path to their global goal, using Theta* algorithm. After getting of global path (which is a sequence of points in space, where the first point is the global goal), agent begin moving. First target point is the last element in path sequence. At each simulation step, for each agent, a new velocity <em>Vnew</em> are searched, using ORCA algorithm. After that global simulation time is changed to <em>dt</em>, the position of all agents is changed to <em>dt</em> * <em>Vnew</em> (own for each agent) and every agent compute new target point. If the agent has reached the last point in the sequence, then the next point in the sequence becomes the target, and the previous one is deleted. Otherwise, a visibility check is made between the agent’s position and the last point. If visibility is confirmed, then the last becomes the target point, otherwise the path from the agent's position to the last point is searched.</p>
<p>Block scheme of the algorithm is shown in the figures below.</p>
<div class="image">
<img src="./images/scheme.png"  width="1000" alt="Algorithm block sheme"/>
</div>
 <p>The implementation of ORCA* algorithm located in <code>./ORCAStarLib/</code> subdirectory. It based on [<a href="https://github.com/PathPlanning/ORCA-algorithm">4</a>]. Implementation relies only on C++11 standard and STL. I/O modules use open-source library tinyXML to work with XML. It is included at the source level (i.e. .h and .cpp files are part of the project) in <code>./ORCAStarLib/tinyxml/</code> subdirectory. Full documentation for ORCA* implementation source code located <a href="https://pathplanning.github.io/ORCAStarROS/group__ORCAStarLib.html">here</a>.</p>
<h2>ROS Imlemetation</h2>
<h3>Requirements</h3>
<p>To build and run ORCA* ROS you nedd the following software:</p><ul>
<li>C++ compiler with C++11 support (tested on GCC 5.4.0);</li>
<li>Python 2.7;</li>
<li>CMake 3.5;</li>
<li>ROS Kinetic (Desktop-Full) [<a href="http://wiki.ros.org/kinetic/Installation">5</a>];</li>
<li>ROS map_server [<a href="http://wiki.ros.org/map_server">6</a>] .</li>
</ul>
<p>Tested on the following configuration:</p>
<div class="image">
<img src="./images/pc.png"  width="500" alt="Map sheme"/>
</div>
 <h3>Installing</h3>
<p>Download current repository to your local machine. Use</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone https://github.com/PathPlanning/ORCAStarROS.git</div></div><!-- fragment --><p> or direct downloading.</p>
<p>Add installation path to ROS_PACKAGE_PATH variable </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;export ROS_PACKAGE_PATH=*installation path*:$ROS_PACKAGE_PATH</div></div><!-- fragment --><h3>Build</h3>
<p>Go to the directory with ORCAStar using teminal.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;roscd ORCAStarROS</div></div><!-- fragment --><p>Start building process using rosmake </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rosmake .</div></div><!-- fragment --><h3>Run Tests</h3>
<p>Tests use gtest library, which is included to ROS. To build tests run following command:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;make test</div></div><!-- fragment --><p>To run tests run commands:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd bin/test</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;./ORCAStarTest </div></div><!-- fragment --><h3>Single <a class="el" href="classAgent.html" title="Agent class implements base agent interface and behavior. ">Agent</a></h3>
<p>The main part in a navigation system is the single agent navigation module. This component can be used both for embedding a separate robot and for centralized calculation of trajectories, but using distributed computing. The single agent navigation implemented as a ROS node. The node operation is divided into 2 stages.</p>
<p>At the first stage, node is initialized, the algorithms parameters and static environment data are requested from ROS services, global path is created. The node sends a request to service <code>initAgentServer_*id*</code>(Service description: <a href="https://pathplanning.github.io/ORCAStarROS/srv/Init.html">here</a>, <code>id</code> is identifier of agent, which sets as ROS private parameter) and awaits a response. For using ROS <a class="el" href="classAgent.html" title="Agent class implements base agent interface and behavior. ">Agent</a> node you should launch such service. After that, the node sends a request to the service <code>static_map</code> of <code>map_server</code> node. You should launch this node before launching ROS <a class="el" href="classAgent.html" title="Agent class implements base agent interface and behavior. ">Agent</a> node.</p>
<p>At the second stage the process of following the global path starts. The node waits for messages in topic <code>AgentInput_*id*</code>. After a message with input data (<a href="https://pathplanning.github.io/ORCAStarROS/msg/ORCAInput.html">msg description</a>) appears in the topic <code>AgentInput_*id*</code>, new velocity computation procedure starts. New velocity publishes in the topic <code>AgentOutput_*id*</code> (in <a href="http://docs.ros.org/api/geometry_msgs/html/msg/Point32.html">geometry_msgs::Point32</a> format). The second stage continues until the node is working. An illustration of the operation of the node is presented in the figure below.</p>
<div class="image">
<img src="./images/ROSAgent.png"  width="300" alt="Map sheme"/>
</div>
 <h4>Launch</h4>
<p>To launch single agent ROS node <code>rosrun</code> util can be used. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rosrun ORCAStar ROSAgent _id:=0</div></div><!-- fragment --><p> Roslaunch files also can be used. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSAgent_0)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSAgent&quot;</span>&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;id&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;&lt;/<span class="keywordtype">node</span>&gt;</div></div><!-- fragment --><p> If you are launching a single instance of the node, then use parameter <code>id</code> equal to any integer (0 for example). When running multiple instances, use unique values.</p>
<h4>I/O Format</h4>
<p>As input and output uses following ROS services and topics:</p><ul>
<li><code>initAgentServer_id</code> — initial input data service, which uses <a href="https://pathplanning.github.io/ORCAStarROS/srv/Init.html">Init service format</a>. Initial input data contains algorithms parameters, agent parameters, start and goal positions and static obstacles description in form of polygons.</li>
<li><code>static_map</code> — service of <code>map_server</code> [<a href="http://wiki.ros.org/map_server">6</a>] node, which stores information about static environment in form of grid.</li>
<li><code>AgentInput_*id*</code> — ROS topic for providing input data on each step of following the global path. It uses <a href="https://pathplanning.github.io/ORCAStarROS/msg/ORCAInput.html">ORCAInput message format</a>, which includes current position and velocity of agent and states of other agents.</li>
<li><code>AgentOutput_*id*</code> — ROS topic for receiving result velocity from ORCAStar algorithm. It uses <a href="http://docs.ros.org/api/geometry_msgs/html/msg/Point32.html">geometry_msgs::Point32</a> message format.</li>
</ul>
<h4><a class="el" href="classMap.html" title="Map class describes static environment. ">Map</a> Format</h4>
<p>The map is set in the form of a grid, are also described in the form of polygons. The grid is a rectangular matrix of square cells, each cell can be traversable or not. The size of cell side is variable. The address of each cell on the grid is specified by a pair <code>(i, j)</code>, where <code>i</code> is the row number of the matrix, <code>j</code> is the column number of the matrix. The environment description is specified in the orthogonal coordinates. Every obstacle in form of polygon is vector of points in orthogonal coordinates. Vertices of the simple obstacle shold be listed in counterclockwise order, vertices of boundary in clockwise order. An illustration of the environment is presented in the figure below.</p>
<div class="image">
<img src="./images/map.png"  width="500" alt="Map sheme"/>
</div>
 <h3>Multiple Agents</h3>
<p>Based on the autonomous navigation module of a single agent, a simple simulation of the work of a group of agents was built. These modules can be used to verify the operation of the navigation system or as an example of using a single agent module.</p>
<p>System includes the following modules. The main module (<code><a class="el" href="classROSMission.html" title="Class is an implementation of multiagent navigation ROS module. ">ROSMission</a></code>) is responsible for storing, updating and transmitting data about the state of the entire system. Intermediate module (<code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code>) is responsible for the interaction between the main module and the single agent navigation module. A navigation module for a single agent (<code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code>). In addition, the system uses a standard ROS node that provides environmental information on request in the format of a grid ([<a href="http://wiki.ros.org/map_server">6</a>]).</p>
<p>At the initial stage of operation, the <code><a class="el" href="classROSMission.html" title="Class is an implementation of multiagent navigation ROS module. ">ROSMission</a></code> node reads information on the agents parameters, start and end positions, as well as data on static obstacles from an XML file, the path to which is specified in the format of the private ROS parameter. After that, agents are registered in <code><a class="el" href="classROSMission.html" title="Class is an implementation of multiagent navigation ROS module. ">ROSMission</a></code>. The main module creates the initialization service and expects the required number of requests (equal to the number of agents), in response to each request, the identifier of the new registered participant in the system, data on the initial and final position of the new agent, agent parameters and data on the static environment are transmitted. When the required number of agents has been registered, the central module creates a topic where the states of all agents are published at discrete time steps. In addition, the central module subscribes to the topic where the results of calculating the new velocities of each agent are published. After the preparatory operations are completed, a cyclic process is started, consisting of publishing the states of agents, obtaining speeds, updating the status of agents. The period of operation of one iteration of the cycle is constant, i.e. new iterations are launched at regular intervals.</p>
<p>During the initial stage, every <code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> node sends a request to the central module to register a new participant in the system and obtain the necessary input data for a specific agent. Then, in a similar way, the <code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code> navigation module is initialized (a <code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> node creates a service waiting for a request from a <code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code> node). The navigation module also requests information about static obstacles in the format of a grid from the map_server node. Every <code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> node subscribes to a topic containing the states of all agents and registers as a publisher in a topic that accepts all computed agent velocities. In addition, two-way communication is creating using topics between the intermediate module and the single agent navigation module.</p>
<p>After the initial stage is completed, the <code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> nodes wait publication of data on the current state of all agents, then every <code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> node selects the neighbors of the specific agent. An input message is generated for <code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code> node. The <code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code> nodes receive input, compute the velocity, and pass velocities back to the <code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> nodes. An illustration of nodes with ROS themes for a system of 5 agents is presented in the figure below.</p>
<div class="image">
<img src="./images/nodes.png"  width="500" alt="Map sheme"/>
</div>
 <h4>Launch</h4>
<p>To launch ROS Mission it is recommended to use <code>roslaunch</code>. The following nodes must be started:</p><ul>
<li><code><a class="el" href="classROSMission.html" title="Class is an implementation of multiagent navigation ROS module. ">ROSMission</a></code> — the main node, which manage all simulation;<ul>
<li><code>agents_number</code> — integer parameter, which defines the number of agents in simulation;</li>
<li><code>task</code> — string parameter, which defines a global path to input XML file;</li>
<li><code>threshhold</code> — integer parameter, which defines a step threshhold for simulation;</li>
<li><code>end</code> — boolean parameter, which sets the simulation to stop when all agents reach their goal positions or step counter reach the threshold of steps.</li>
</ul>
</li>
<li><code>map_server</code> — the node, which stores information about static environment in form of grid [<a href="http://wiki.ros.org/map_server">6</a>].</li>
<li><code><a class="el" href="classROSSimActor.html" title="The ROSSimActor class is implementation of the intermediate node between the simulation and the agent...">ROSSimActor</a></code> — the intermediate node between the simulation and the agent. Responsible for transmitting only the necessary information from <code><a class="el" href="classROSMission.html" title="Class is an implementation of multiagent navigation ROS module. ">ROSMission</a></code> to <code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code>. You must run the same number of nodes as the number of agents in the simulation</li>
<li><code><a class="el" href="classROSAgent.html" title="Class is an implementation of single agent navigation ROS module based on ORCAStar algorithm...">ROSAgent</a></code> — a single agent navigation node. You must run the same number of nodes as the number of agents in the simulation;<ul>
<li><code>id</code> — integer parameter, which defines the identifier of agent. Should be unique.</li>
</ul>
</li>
<li><code>ROSVisualization</code>, <code>rviz</code> — optional nodes for visualization.</li>
</ul>
<p>Python script <code>./scripts/generate.py</code> can be used for generating launch files from XML task files.</p>
<p>Example of launch file is presented below and in <code>./examples/</code> subdirectory.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;<span class="keywordtype">launch</span>&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;map_server&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;map_server&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;map_server&quot;</span> <span class="keyword">args</span>=<span class="stringliteral">&quot;/home/User/ORCAStar/examples/0_task.yml&quot;</span>/&gt;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ROSMission&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSMission&quot;</span> <span class="keyword">output</span>=<span class="stringliteral">&quot;screen&quot;</span>&gt;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;agents_number&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;5&quot;</span>/&gt;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;task&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;string&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;/home/User/ORCAStar/examples/0_task.xml&quot;</span>/&gt;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;threshhold&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;1000&quot;</span>/&gt;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;end&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;bool&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;False&quot;</span>/&gt;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  &lt;/<span class="keywordtype">node</span>&gt;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSSimActor_0)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSSimActor&quot;</span>/&gt;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSAgent_0)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSAgent&quot;</span>&gt;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;id&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0&quot;</span>/&gt;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  &lt;/<span class="keywordtype">node</span>&gt;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSSimActor_1)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSSimActor&quot;</span>/&gt;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSAgent_1)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSAgent&quot;</span>&gt;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;id&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;1&quot;</span>/&gt;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  &lt;/<span class="keywordtype">node</span>&gt;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSSimActor_2)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSSimActor&quot;</span>/&gt;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSAgent_2)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSAgent&quot;</span>&gt;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;id&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;2&quot;</span>/&gt;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  &lt;/<span class="keywordtype">node</span>&gt;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSSimActor_3)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSSimActor&quot;</span>/&gt;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSAgent_3)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSAgent&quot;</span>&gt;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;id&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;3&quot;</span>/&gt;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  &lt;/<span class="keywordtype">node</span>&gt;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSSimActor_4)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSSimActor&quot;</span>/&gt;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;$(anon ROSAgent_4)&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSAgent&quot;</span>&gt;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    &lt;<span class="keywordtype">param</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;id&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;int&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;4&quot;</span>/&gt;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  &lt;/<span class="keywordtype">node</span>&gt;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;rviz&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;rviz&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;rviz&quot;</span>/&gt;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  &lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ROSVisualization&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSVisualization&quot;</span>/&gt;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;&lt;/<span class="keywordtype">launch</span>&gt;</div></div><!-- fragment --><h4>I/O Format</h4>
<p>Input files are an XML files with a specific structure. <a class="el" href="classMap.html" title="Map class describes static environment. ">Map</a> format is the same as for single agent. Example of XML files are presented in <code>./examples/</code> subdirectory. Input file should contain:</p>
<ul>
<li>Mandatory tag <code>&lt;agents&gt;</code>. It describes the parameters of the agents.<ul>
<li><code>number</code> — mandatory attribute that define the number of agents;</li>
<li><code>&lt;default_parameters&gt;</code> — mandatory tags that defines default parameters of agents and agent's perception.<ul>
<li><code>agentsmaxnum</code> — mandatory attribute that defines a number of neighbors, that the agent takes into account;</li>
<li><code>movespeed</code> — mandatory attribute that defines maximum speed of agent;</li>
<li><code>sightradius</code> — mandatory attribute that defines the radius in which the agent takes neighbors into account;</li>
<li><code>size</code> — mandatory attribute that defines size of the agent (radius of the agent);</li>
<li><code>timeboundary</code> — mandatory attribute that defines the time within which the algorithm ensures collision avoidance with other agents;</li>
<li><code>timeboundaryobst</code> — mandatory attribute that defines the time within which the algorithm ensures collision avoidance with static obstacles.</li>
</ul>
</li>
<li><code>&lt;agent&gt;</code> — mandatory tags that defines parameters of each agent.<ul>
<li><code>id</code> — mandatory attribute that defines the identifier of agent;</li>
<li><code>start.xr</code> — mandatory attribute that defines the coordinate of start position on the x-axis (hereinafter, excluding <code>map</code> tag, points (x,y) are in coordinate system, which has an origin (0,0) in lower left corner. More about coordinate systems in the map format section);</li>
<li><code>start.yr</code> — mandatory attribute that defines the coordinate of start position on the y-axis;</li>
<li><code>goal.xr</code> — mandatory attribute that defines the coordinate of finish position on the x-axis;</li>
<li><code>goal.yr</code> — mandatory attribute that defines the coordinate of finish position on the y-axis;</li>
<li><code>agentsmaxnum</code> — attribute that defines a number of neighbors, that the agent takes into account;</li>
<li><code>movespeed</code> — attribute that defines maximum speed of agent;</li>
<li><code>sightradius</code> — attribute that defines the radius in which the agent takes neighbors into account;</li>
<li><code>size</code> — attribute that defines size of the agent (radius of the agent);</li>
<li><code>timeboundary</code> — attribute that defines the time within which the algorithm ensures collision avoidance with other agents;</li>
<li><code>timeboundaryobst</code> — attribute that define the time within which the algorithm ensures collision avoidance with static obstacles.</li>
</ul>
</li>
</ul>
</li>
<li>Mandatory tag <code>&lt;map&gt;</code>. It describes the environment for global path planning.<ul>
<li><code>&lt;height&gt;</code> and <code>&lt;width&gt;</code> — mandatory tags that define size of the map. Origin is in the upper left corner. (0,0) - is upper left, (<em>width</em>-1, <em>height</em>-1) is lower right (more about coordinate systems in the map format section.</li>
<li><code>&lt;cellsize&gt;</code> — optional tag that defines the size of one cell.</li>
<li><code>&lt;grid&gt;</code> — mandatory tag that describes the square grid constituting the map. It consists of <code>&lt;row&gt;</code> tags. Each <code>&lt;row&gt;</code> contains a sequence of "0" and "1" separated by blanks. "0" stands for traversable cell, "1" — for untraversable (actually any other figure but "0" can be used instead of "1").</li>
</ul>
</li>
<li>Mandatory tag <code>&lt;obstacles&gt;</code>. It describes static obstacles for collision avoidance.<ul>
<li><code>number</code> — mandatory attribute that defines the number of obstacles;</li>
<li><code>&lt;obstacle&gt;</code> — mandatory tags which defines each static obstacles for collision avoidance.<ul>
<li><code>&lt;vertex&gt;</code> — mandatory tags which defines vertex of static obstacle for collision avoidance.<ul>
<li><code>xr</code> — mandatory attribute that defines the coordinate of vertex on the x-axis;</li>
<li><code>yr</code> — mandatory attribute that defines the coordinate of vertex on the y-axis.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Mandatory tag <code>&lt;algorithm&gt;</code>. It describes the parameters of the algorithm.<ul>
<li><code>&lt;delta&gt;</code> — mandatory tag that defines the distance between the center of the agent and the finish, which is enough to reach the finish (ORCA parameter);</li>
<li><code>&lt;timestep&gt;</code> — mandatory tag that defines the time step of simulation (ORCA parameter);</li>
<li><code>&lt;searchtype&gt;</code> — tag that defines the type of planning. Possible values - "thetastar" (use Theta* for planning), "direct" (turn off global planning and always use direction to global goal). Default value is "thetastar" (global planning parameter);</li>
<li><code>&lt;breakingties&gt;</code> — tag that defines the priority in OPEN list for nodes with equal f-values. Possible values - "0" (break ties in favor of the node with smaller g-value), "1" (break ties in favor of the node with greater g-value). Default value is "0" (Theta* parameter);</li>
<li><code>&lt;cutcorners&gt;</code> — boolean tag that defines the possibilty to make diagonal moves when one adjacent cell is untraversable. The tag is ignored if diagonal moves are not allowed. Default value is "false" (Theta* parameter);</li>
<li><code>&lt;allowsqueeze&gt;</code> — boolean tag that defines the possibility to make diagonal moves when both adjacent cells are untraversable. The tag is ignored if cutting corners is not allowed. Default value is "false" (Theta* parameter);</li>
<li><code>&lt;hweight&gt;</code> — defines the weight of the heuristic function. Should be real number greater or equal 1. Default value is "1" (Theta* parameter);</li>
</ul>
</li>
</ul>
<p>Output of simulation is made to topic <code>AgentStates</code> using message format <a href="https://pathplanning.github.io/ORCAStarROS/msg/AgentState.html">AgentState</a>. It includes positions, velocities and sizes of all agent on current step.</p>
<h4>Visualisation</h4>
<p>The simulation visualized using <code>rviz</code>. To use visualization add floowing nodes to the launch file. Examples of rviz config files are presented in <code>./examples/</code> subdirectory.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;rviz&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;rviz&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;rviz&quot;</span>/&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;&lt;<span class="keywordtype">node</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;ROSVisualization&quot;</span> <span class="keyword">pkg</span>=<span class="stringliteral">&quot;ORCAStar&quot;</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;ROSVisualization&quot;</span>/&gt;</div></div><!-- fragment --><p>Example of visualized simulation is presented below.</p>
<div class="image">
<img src="./images/vis.gif"  width="700" alt="vis"/>
</div>
 <h2>Source Code Documentation</h2>
<p>Full source code documentation is presented <a href="https://pathplanning.github.io/ORCAStarROS/">here</a>.</p>
<p>Documentation for ROS messages and services is presented <a href="https://pathplanning.github.io/ORCAStarROS/index-msg.html">here</a></p>
<h2>Links</h2>
<ol type="1">
<li><a href="https://arxiv.org/pdf/1401.3843.pdf">Daniel K. et al. Theta*: Any-angle path planning on grids // Journal of Artificial Intelligence Research. – 2010. – vol. 39. – p. 533-579.</a></li>
<li><a href="http://gamma.cs.unc.edu/ORCA/publications/ORCA.pdf">Van Den Berg J. et al. Reciprocal n-body collision avoidance // Robotics research. – Springer, Berlin, Heidelberg, 2011. – p. 3-19.</a></li>
<li><a href="http://gamma.cs.unc.edu/ORCA/">ORCA creators webpage</a></li>
<li><a href="https://github.com/PathPlanning/ORCA-algorithm">ORCA* algoritm implementation</a></li>
<li><a href="http://wiki.ros.org/kinetic/Installation">ROS Kinetic installation instructions</a></li>
<li><a href="http://wiki.ros.org/map_server">map_server node description</a> </li>
</ol>
</div></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/ORCAStar">ORCAStar</a><br />
Author(s): Stepan Drgachev</br />
<small>autogenerated on Wed Jul 15 2020 16:13:14</small>
</div>
</body>
</html>
